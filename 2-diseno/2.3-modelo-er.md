# Modelo Relacional - Sistema de Denuncias Ciudadanas

# Diagrama Relacional

![Diagrama relacional](/images/2/diagrama_relacional.svg)

# Diccionario de Datos

## Índice de Módulos
- [1. Módulo de Ciudadanos](#1-módulo-de-ciudadanos)
- [2. Módulo de Personal Municipal](#2-módulo-de-personal-municipal)
- [3. Módulo de Notificaciones](#3-módulo-de-notificaciones)
- [4. Módulo Administrativo](#4-módulo-administrativo)
- [5. Módulo de Reportes y Estadísticas](#5-módulo-de-reportes-y-estadísticas)

---

## 1. Módulo de Ciudadanos

### Diccionario de Datos

#### Tabla: Ciudadano
- **Descripción:** Registra la información de los ciudadanos que realizan denuncias en el sistema.
- **Propósito:** Identificar y almacenar los datos principales de cada ciudadano denunciante.
- **Reglas de Negocio:**
  - Cada ciudadano debe tener un DNI único.
  - El DNI debe seguir el formato de 8 dígitos.
  - Puede registrar denuncias de forma anónima.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_ciudadano | Identificador único del ciudadano | PK UUID | CHAR(36) | Sí | Sí | No | 650e8400-e29b-41d4-a716-446655440018 |
| codigo_ciudadano | Código del ciudadano | Identificación interna | VARCHAR(20) | Sí | Sí | No | CIU-00001 |
| dni | Documento Nacional de Identidad | Identificación legal | CHAR(8) | Sí | Sí | No | 45678912 |
| nombre | Nombre del ciudadano | Identificación | VARCHAR(100) | Sí | No | No | María |
| apellido | Apellido del ciudadano | Identificación | VARCHAR(100) | Sí | No | No | González |
| email | Correo electrónico | Comunicación | VARCHAR(100) | No | Sí | No | maria.g@email.com |
| direccion | Dirección del ciudadano | Ubicación | VARCHAR(200) | No | No | No | Jr. Lima 456 |
| fecha_emision_dni | Fecha de emisión del DNI | Autenticación | DATE | Sí | No | No | 2020-05-15 |
| fecha_registro | Fecha de registro en el sistema | Control temporal | DATETIME | Sí | No | No | 2025-01-10 08:30:00 |
| es_anonimo | Indica si la cuenta es anónima | Control privacidad | BOOLEAN | Sí | No | No | false |
| estado_cuenta | Estado de la cuenta | Control | VARCHAR(20) | Sí | No | No | Activo |

**Índices:**
- PRIMARY KEY (id_ciudadano)
- UNIQUE KEY uk_codigo (codigo_ciudadano)
- UNIQUE KEY uk_dni (dni)
- UNIQUE KEY uk_email (email)
- INDEX idx_estado (estado_cuenta)

---

#### Tabla: CiudadanoTelefono
- **Descripción:** Números de teléfono asociados a ciudadanos.
- **Propósito:** Permitir que un ciudadano tenga múltiples números de contacto.
- **Reglas de Negocio:**
  - Un ciudadano puede tener cero o más teléfonos.
  - Un número de teléfono no puede repetirse para el mismo ciudadano.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_ciudadano_telefono | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 750e8400-e29b-41d4-a716-446655440019 |
| id_ciudadano | Referencia al ciudadano | Relación | CHAR(36) | Sí | No | Sí | 650e8400-e29b-41d4-a716-446655440018 |
| telefono | Número de teléfono | Contacto | VARCHAR(20) | Sí | No | No | 987654321 |
| es_principal | Indica si es teléfono principal | Control | BOOLEAN | Sí | No | No | true |

**Índices:**
- PRIMARY KEY (id_ciudadano_telefono)
- UNIQUE KEY uk_ciudadano_telefono (id_ciudadano, telefono)
- FOREIGN KEY (id_ciudadano) REFERENCES Ciudadano(id_ciudadano) ON DELETE CASCADE

---

#### Tabla: Categoria
- **Descripción:** Clasificación temática de las denuncias.
- **Propósito:** Organizar y categorizar las denuncias para su correcta asignación.
- **Reglas de Negocio:**
  - Cada categoría debe tener un código único.
  - Debe tener un área responsable asignada.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_categoria | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 850e8400-e29b-41d4-a716-446655440020 |
| codigo_categoria | Código de la categoría | Identificación | VARCHAR(20) | Sí | Sí | No | CAT-001 |
| nombre | Nombre de la categoría | Identificación | VARCHAR(100) | Sí | Sí | No | Alumbrado Público |
| descripcion | Descripción de la categoría | Información | VARCHAR(500) | No | No | No | Problemas con el alumbrado |
| color | Color para identificación visual | UI/UX | VARCHAR(7) | No | No | No | #FF5733 |
| icono | Icono representativo | UI/UX | VARCHAR(50) | No | No | No | lightbulb |
| esta_activo | Estado de la categoría | Control | BOOLEAN | Sí | No | No | true |
| tiempo_respuesta_promedio | Tiempo promedio de atención (horas) | Planificación | INT | No | No | No | 72 |
| id_area_responsable | Área responsable de la categoría | Relación | CHAR(36) | Sí | No | Sí | 950e8400-e29b-41d4-a716-446655440021 |

**Índices:**
- PRIMARY KEY (id_categoria)
- UNIQUE KEY uk_codigo (codigo_categoria)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_activo (esta_activo)
- FOREIGN KEY (id_area_responsable) REFERENCES AreaResponsable(id_area_responsable)

---

#### Tabla: Denuncia
- **Descripción:** Registro principal de denuncias realizadas por los ciudadanos.
- **Propósito:** Gestionar las denuncias ciudadanas desde su registro hasta su resolución.
- **Reglas de Negocio:**
  - Cada denuncia debe tener un código único.
  - Debe estar asociada a una categoría.
  - Requiere una ubicación geográfica.
  - El estado inicial es "Registrado".

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_denuncia | Identificador único de la denuncia | PK UUID | CHAR(36) | Sí | Sí | No | a50e8400-e29b-41d4-a716-446655440022 |
| codigo_denuncia | Código de la denuncia | Identificación | VARCHAR(20) | Sí | Sí | No | DEN-2025-00001 |
| titulo | Título breve de la denuncia | Resumen | VARCHAR(100) | Sí | No | No | Bache en Av. Principal |
| descripcion | Descripción detallada del problema | Información | TEXT | Sí | No | No | Bache grande que causa... |
| fecha_registro | Fecha de registro | Control temporal | DATETIME | Sí | No | No | 2025-01-10 14:30:00 |
| fecha_actualizacion | Última actualización | Control temporal | DATETIME | Sí | No | No | 2025-01-12 09:15:00 |
| estado | Estado actual de la denuncia | Seguimiento | VARCHAR(20) | Sí | No | No | En revisión |
| prioridad | Nivel de prioridad | Gestión | VARCHAR(20) | Sí | No | No | Media |
| es_anonima | Indica si es anónima | Privacidad | BOOLEAN | Sí | No | No | false |
| numero_seguimiento | Código para seguimiento público | Trazabilidad | VARCHAR(20) | Sí | Sí | No | SEG-ABC123456 |
| requiere_validacion | Necesita doble autenticación | Control | BOOLEAN | Sí | No | No | true |
| id_ciudadano | Ciudadano que registra | Relación | CHAR(36) | No | No | Sí | 650e8400-e29b-41d4-a716-446655440018 |
| id_categoria | Categoría de la denuncia | Relación | CHAR(36) | Sí | No | Sí | 850e8400-e29b-41d4-a716-446655440020 |
| id_ubicacion | Ubicación del problema | Relación | CHAR(36) | Sí | No | Sí | b50e8400-e29b-41d4-a716-446655440023 |

**Índices:**
- PRIMARY KEY (id_denuncia)
- UNIQUE KEY uk_codigo (codigo_denuncia)
- UNIQUE KEY uk_seguimiento (numero_seguimiento)
- INDEX idx_estado (estado)
- INDEX idx_prioridad (prioridad)
- INDEX idx_fecha_registro (fecha_registro)
- FOREIGN KEY (id_ciudadano) REFERENCES Ciudadano(id_ciudadano) ON DELETE SET NULL
- FOREIGN KEY (id_categoria) REFERENCES Categoria(id_categoria)
- FOREIGN KEY (id_ubicacion) REFERENCES Ubicacion(id_ubicacion)

---

#### Tabla: Ubicacion
- **Descripción:** Información geográfica de la denuncia.
- **Propósito:** Geolocalizar las denuncias para análisis espacial y asignación.
- **Reglas de Negocio:**
  - Debe contener coordenadas GPS o dirección.
  - Debe pertenecer a una zona del municipio.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_ubicacion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | b50e8400-e29b-41d4-a716-446655440023 |
| codigo_ubicacion | Código de ubicación | Identificación | VARCHAR(20) | Sí | Sí | No | UBI-00001 |
| latitud | Coordenada latitud | Geolocalización | DECIMAL(10,8) | Sí | No | No | -12.046374 |
| longitud | Coordenada longitud | Geolocalización | DECIMAL(11,8) | Sí | No | No | -77.042793 |
| direccion | Dirección textual | Ubicación | VARCHAR(200) | Sí | No | No | Av. Arequipa 1234 |
| referencia | Referencia adicional | Ubicación | VARCHAR(200) | No | No | No | Frente al parque |
| distrito | Distrito del municipio | Clasificación | VARCHAR(100) | Sí | No | No | Miraflores |
| codigo_postal | Código postal | Clasificación | VARCHAR(10) | No | No | No | 15047 |

**Índices:**
- PRIMARY KEY (id_ubicacion)
- UNIQUE KEY uk_codigo (codigo_ubicacion)
- INDEX idx_distrito (distrito)
- INDEX idx_coordenadas (latitud, longitud)

---

#### Tabla: Evidencia
- **Descripción:** Archivos multimedia adjuntos a una denuncia.
- **Propósito:** Almacenar fotografías, videos o documentos que respalden la denuncia.
- **Reglas de Negocio:**
  - Máximo 5 archivos por denuncia.
  - Tamaño máximo según políticas de seguridad.
  - Tipos permitidos: imágenes (JPG, PNG), videos (MP4), documentos (PDF).

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_evidencia | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | c50e8400-e29b-41d4-a716-446655440024 |
| codigo_evidencia | Código de evidencia | Identificación | VARCHAR(20) | Sí | Sí | No | EVI-00001 |
| nombre_archivo | Nombre original del archivo | Identificación | VARCHAR(255) | Sí | No | No | foto_bache.jpg |
| ruta_almacenamiento | Ruta de almacenamiento encriptada | Almacenamiento | VARCHAR(500) | Sí | Sí | No | /encrypted/2025/01/... |
| tipo_archivo | Tipo MIME del archivo | Clasificación | VARCHAR(100) | Sí | No | No | image/jpeg |
| tamaño_bytes | Tamaño en bytes | Control | BIGINT | Sí | No | No | 2048576 |
| fecha_carga | Fecha de carga | Control temporal | DATETIME | Sí | No | No | 2025-01-10 14:32:00 |
| hash_archivo | Hash SHA-256 del archivo | Integridad | VARCHAR(64) | Sí | Sí | No | a3f5d8c9... |
| esta_escaneado | Verificación antivirus | Seguridad | BOOLEAN | Sí | No | No | true |
| id_denuncia | Denuncia asociada | Relación | CHAR(36) | Sí | No | Sí | a50e8400-e29b-41d4-a716-446655440022 |

**Índices:**
- PRIMARY KEY (id_evidencia)
- UNIQUE KEY uk_codigo (codigo_evidencia)
- UNIQUE KEY uk_hash (hash_archivo)
- INDEX idx_denuncia (id_denuncia)
- INDEX idx_tipo (tipo_archivo)
- FOREIGN KEY (id_denuncia) REFERENCES Denuncia(id_denuncia) ON DELETE CASCADE

---

#### Tabla: Seguimiento
- **Descripción:** Registro de cambios de estado y actualizaciones de la denuncia.
- **Propósito:** Mantener trazabilidad completa de las acciones sobre cada denuncia.
- **Reglas de Negocio:**
  - Se crea un registro cada vez que cambia el estado.
  - Es inmutable una vez creado.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_seguimiento | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | d50e8400-e29b-41d4-a716-446655440025 |
| codigo_seguimiento | Código de seguimiento | Identificación | VARCHAR(20) | Sí | Sí | No | SEG-00001 |
| estado_anterior | Estado previo | Historial | VARCHAR(20) | No | No | No | Registrado |
| estado_nuevo | Estado actual | Historial | VARCHAR(20) | Sí | No | No | En revisión |
| fecha_hora | Fecha y hora del cambio | Control temporal | DATETIME | Sí | No | No | 2025-01-11 10:00:00 |
| comentario | Observación del cambio | Información | TEXT | No | No | No | Asignado a área... |
| es_visible | Visible para ciudadano | Control | BOOLEAN | Sí | No | No | true |
| id_denuncia | Denuncia asociada | Relación | CHAR(36) | Sí | No | Sí | a50e8400-e29b-41d4-a716-446655440022 |
| id_usuario | Usuario que registra | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_seguimiento)
- UNIQUE KEY uk_codigo (codigo_seguimiento)
- INDEX idx_denuncia (id_denuncia)
- INDEX idx_fecha (fecha_hora)
- FOREIGN KEY (id_denuncia) REFERENCES Denuncia(id_denuncia) ON DELETE CASCADE
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario)

---

## 2. Módulo de Personal Municipal

### Diccionario de Datos

#### Tabla: PersonalMunicipal
- **Descripción:** Empleados del municipio que gestionan las denuncias.
- **Propósito:** Gestionar el personal responsable de atender y resolver denuncias.
- **Reglas de Negocio:**
  - Cada personal debe tener un código único.
  - Debe pertenecer a un área específica.
  - El DNI debe ser único en el sistema.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_personal | Identificador único del personal | PK UUID | CHAR(36) | Sí | Sí | No | f50e8400-e29b-41d4-a716-446655440027 |
| codigo_personal | Código del empleado | Identificación interna | VARCHAR(20) | Sí | Sí | No | PER-00001 |
| dni | Documento de identidad | Identificación legal | CHAR(8) | Sí | Sí | No | 87654321 |
| nombre | Nombre del empleado | Identificación | VARCHAR(100) | Sí | No | No | Carlos |
| apellido | Apellido del empleado | Identificación | VARCHAR(100) | Sí | No | No | Rodríguez |
| email | Correo institucional | Comunicación | VARCHAR(100) | Sí | Sí | No | crodriguez@muni.gob.pe |
| cargo | Cargo del empleado | Clasificación | VARCHAR(100) | Sí | No | No | Técnico |
| fecha_ingreso | Fecha de ingreso | Control temporal | DATE | Sí | No | No | 2023-05-10 |
| estado_laboral | Estado del empleado | Control | VARCHAR(20) | Sí | No | No | Activo |
| especialidad | Área de especialización | Clasificación | VARCHAR(100) | No | No | No | Infraestructura |
| id_area_responsable | Área a la que pertenece | Relación | CHAR(36) | Sí | No | Sí | 950e8400-e29b-41d4-a716-446655440021 |
| id_usuario | Usuario del sistema | Relación | CHAR(36) | Sí | Sí | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_personal)
- UNIQUE KEY uk_codigo (codigo_personal)
- UNIQUE KEY uk_dni (dni)
- UNIQUE KEY uk_email (email)
- UNIQUE KEY uk_usuario (id_usuario)
- INDEX idx_area (id_area_responsable)
- INDEX idx_estado (estado_laboral)
- FOREIGN KEY (id_area_responsable) REFERENCES AreaResponsable(id_area_responsable)
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario)

---

#### Tabla: PersonalTelefono
- **Descripción:** Números de teléfono asociados al personal municipal.
- **Propósito:** Permitir que un personal tenga múltiples números de contacto.
- **Reglas de Negocio:**
  - Un personal puede tener cero o más teléfonos.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_personal_telefono | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 050f8400-e29b-41d4-a716-446655440028 |
| id_personal | Referencia al personal | Relación | CHAR(36) | Sí | No | Sí | f50e8400-e29b-41d4-a716-446655440027 |
| telefono | Número de teléfono | Contacto | VARCHAR(20) | Sí | No | No | 987123456 |
| es_principal | Indica si es teléfono principal | Control | BOOLEAN | Sí | No | No | true |

**Índices:**
- PRIMARY KEY (id_personal_telefono)
- UNIQUE KEY uk_personal_telefono (id_personal, telefono)
- FOREIGN KEY (id_personal) REFERENCES PersonalMunicipal(id_personal) ON DELETE CASCADE

---

#### Tabla: AreaResponsable
- **Descripción:** Departamentos o áreas del municipio responsables de atender denuncias.
- **Propósito:** Organizar la estructura municipal y asignar denuncias correctamente.
- **Reglas de Negocio:**
  - Cada área debe tener un código único.
  - Debe tener un jefe de área asignado.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_area_responsable | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 950e8400-e29b-41d4-a716-446655440021 |
| codigo_area | Código del área | Identificación | VARCHAR(20) | Sí | Sí | No | ARE-001 |
| nombre | Nombre del área | Identificación | VARCHAR(100) | Sí | Sí | No | Obras Públicas |
| descripcion | Descripción del área | Información | VARCHAR(500) | No | No | No | Responsable de... |
| email | Correo del área | Comunicación | VARCHAR(100) | Sí | Sí | No | obras@muni.gob.pe |
| telefono | Teléfono del área | Comunicación | VARCHAR(20) | Sí | No | No | 01-4567890 |
| capacidad_maxima | Denuncias máximas simultáneas | Planificación | INT | Sí | No | No | 50 |
| esta_activo | Estado del área | Control | BOOLEAN | Sí | No | No | true |
| id_jefe_area | Jefe del área | Relación | CHAR(36) | No | No | Sí | f50e8400-e29b-41d4-a716-446655440027 |

**Índices:**
- PRIMARY KEY (id_area_responsable)
- UNIQUE KEY uk_codigo (codigo_area)
- UNIQUE KEY uk_nombre (nombre)
- UNIQUE KEY uk_email (email)
- INDEX idx_activo (esta_activo)
- FOREIGN KEY (id_jefe_area) REFERENCES PersonalMunicipal(id_personal)

---

#### Tabla: Asignacion
- **Descripción:** Registro de asignación de denuncias al personal o áreas.
- **Propósito:** Gestionar la distribución de denuncias para su atención.
- **Reglas de Negocio:**
  - Una denuncia puede ser reasignada múltiples veces.
  - La asignación activa es la más reciente.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_asignacion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 150f8400-e29b-41d4-a716-446655440029 |
| codigo_asignacion | Código de asignación | Identificación | VARCHAR(20) | Sí | Sí | No | ASG-00001 |
| fecha_asignacion | Fecha de asignación | Control temporal | DATETIME | Sí | No | No | 2025-01-11 09:00:00 |
| motivo_asignacion | Razón de la asignación | Información | VARCHAR(500) | No | No | No | Por especialidad |
| es_activa | Indica si es la asignación actual | Control | BOOLEAN | Sí | No | No | true |
| fecha_finalizacion | Fecha de cierre de asignación | Control temporal | DATETIME | No | No | No | 2025-01-15 17:00:00 |
| id_denuncia | Denuncia asignada | Relación | CHAR(36) | Sí | No | Sí | a50e8400-e29b-41d4-a716-446655440022 |
| id_personal_asignado | Personal responsable | Relación | CHAR(36) | Sí | No | Sí | f50e8400-e29b-41d4-a716-446655440027 |
| id_personal_asignador | Personal que asigna | Relación | CHAR(36) | Sí | No | Sí | f50e8400-e29b-41d4-a716-446655440027 |

**Índices:**
- PRIMARY KEY (id_asignacion)
- UNIQUE KEY uk_codigo (codigo_asignacion)
- INDEX idx_denuncia (id_denuncia)
- INDEX idx_activa (es_activa)
- INDEX idx_personal_asignado (id_personal_asignado)
- FOREIGN KEY (id_denuncia) REFERENCES Denuncia(id_denuncia)
- FOREIGN KEY (id_personal_asignado) REFERENCES PersonalMunicipal(id_personal)
- FOREIGN KEY (id_personal_asignador) REFERENCES PersonalMunicipal(id_personal)

---

#### Tabla: Tramitacion
- **Descripción:** Proceso de gestión y resolución de una denuncia.
- **Propósito:** Registrar las acciones tomadas para resolver la denuncia.
- **Reglas de Negocio:**
  - Debe estar asociada a una asignación activa.
  - Puede incluir evidencias de resolución.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_tramitacion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 250f8400-e29b-41d4-a716-446655440030 |
| codigo_tramitacion | Código de tramitación | Identificación | VARCHAR(20) | Sí | Sí | No | TRA-00001 |
| fecha_inicio | Fecha de inicio | Control temporal | DATETIME | Sí | No | No | 2025-01-11 10:00:00 |
| fecha_finalizacion | Fecha de finalización | Control temporal | DATETIME | No | No | No | 2025-01-13 16:30:00 |
| accion_realizada | Descripción de la acción | Información | TEXT | Sí | No | No | Se reparó el bache... |
| observaciones | Observaciones adicionales | Información | TEXT | No | No | No | Se requirió material... |
| costo_estimado | Costo de la intervención | Financiero | DECIMAL(10,2) | No | No | No | 500.00 |
| estado_tramitacion | Estado del trámite | Seguimiento | VARCHAR(20) | Sí | No | No | En proceso |
| id_asignacion | Asignación asociada | Relación | CHAR(36) | Sí | Sí | Sí | 150f8400-e29b-41d4-a716-446655440029 |

**Índices:**
- PRIMARY KEY (id_tramitacion)
- UNIQUE KEY uk_codigo (codigo_tramitacion)
- UNIQUE KEY uk_asignacion (id_asignacion)
- INDEX idx_estado (estado_tramitacion)
- FOREIGN KEY (id_asignacion) REFERENCES Asignacion(id_asignacion)

---

#### Tabla: EvidenciaResolucion
- **Descripción:** Evidencias fotográficas de la resolución de denuncias.
- **Propósito:** Documentar las acciones correctivas realizadas.
- **Reglas de Negocio:**
  - Una tramitación puede tener múltiples evidencias.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_evidencia_resolucion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 350f8400-e29b-41d4-a716-446655440031 |
| nombre_archivo | Nombre del archivo | Identificación | VARCHAR(255) | Sí | No | No | resolucion_bache.jpg |
| ruta_almacenamiento | Ruta del archivo | Almacenamiento | VARCHAR(500) | Sí | Sí | No | /encrypted/resoluciones/... |
| tipo_archivo | Tipo MIME | Clasificación | VARCHAR(100) | Sí | No | No | image/jpeg |
| tamaño_bytes | Tamaño en bytes | Control | BIGINT | Sí | No | No | 1536789 |
| fecha_carga | Fecha de carga | Control temporal | DATETIME | Sí | No | No | 2025-01-13 16:00:00 |
| hash_archivo | Hash SHA-256 | Integridad | VARCHAR(64) | Sí | Sí | No | b4g6e9d0... |
| id_tramitacion | Tramitación asociada | Relación | CHAR(36) | Sí | No | Sí | 250f8400-e29b-41d4-a716-446655440030 |

**Índices:**
- PRIMARY KEY (id_evidencia_resolucion)
- UNIQUE KEY uk_hash (hash_archivo)
- INDEX idx_tramitacion (id_tramitacion)
- FOREIGN KEY (id_tramitacion) REFERENCES Tramitacion(id_tramitacion) ON DELETE CASCADE

---

#### Tabla: Resolucion
- **Descripción:** Resultado final de la atención de una denuncia.
- **Propósito:** Documentar la solución o cierre de la denuncia.
- **Reglas de Negocio:**
  - Una denuncia debe tener una resolución para cerrarse.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_resolucion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 450f8400-e29b-41d4-a716-446655440032 |
| codigo_resolucion | Código de resolución | Identificación | VARCHAR(20) | Sí | Sí | No | RES-00001 |
| fecha_resolucion | Fecha de resolución | Control temporal | DATETIME | Sí | No | No | 2025-01-13 17:00:00 |
| tipo_resolucion | Tipo de resolución | Clasificación | VARCHAR(20) | Sí | No | No | Resuelta |
| descripcion_resolucion | Detalle de la resolución | Información | TEXT | Sí | No | No | Problema solucionado... |
| tiempo_total_horas | Tiempo total de atención | Métrica | INT | Sí | No | No | 54 |
| calificacion_ciudadano | Calificación del ciudadano | Satisfacción | INT | No | No | No | 5 |
| comentario_ciudadano | Comentario del ciudadano | Feedback | TEXT | No | No | No | Excelente servicio |
| id_tramitacion | Tramitación finalizada | Relación | CHAR(36) | Sí | Sí | Sí | 250f8400-e29b-41d4-a716-446655440030 |

**Índices:**
- PRIMARY KEY (id_resolucion)
- UNIQUE KEY uk_codigo (codigo_resolucion)
- UNIQUE KEY uk_tramitacion (id_tramitacion)
- INDEX idx_tipo (tipo_resolucion)
- INDEX idx_fecha (fecha_resolucion)
- FOREIGN KEY (id_tramitacion) REFERENCES Tramitacion(id_tramitacion)

---

#### Tabla: Comunicacion
- **Descripción:** Mensajes intercambiados entre personal y ciudadanos.
- **Propósito:** Facilitar la comunicación bidireccional durante el proceso de atención.
- **Reglas de Negocio:**
  - Puede ser iniciada por el personal o el ciudadano.
  - Debe estar asociada a una denuncia.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_comunicacion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 550f8400-e29b-41d4-a716-446655440033 |
| codigo_comunicacion | Código de comunicación | Identificación | VARCHAR(20) | Sí | Sí | No | COM-00001 |
| mensaje | Contenido del mensaje | Comunicación | TEXT | Sí | No | No | Necesitamos más info... |
| fecha_envio | Fecha y hora de envío | Control temporal | DATETIME | Sí | No | No | 2025-01-12 11:30:00 |
| tipo_remitente | Tipo de quien envía | Clasificación | VARCHAR(20) | Sí | No | No | Personal |
| es_leido | Indica si fue leído | Control | BOOLEAN | Sí | No | No | false |
| requiere_respuesta | Solicita respuesta | Control | BOOLEAN | Sí | No | No | true |
| id_denuncia | Denuncia asociada | Relación | CHAR(36) | Sí | No | Sí | a50e8400-e29b-41d4-a716-446655440022 |
| id_usuario_remitente | Usuario que envía | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_comunicacion)
- UNIQUE KEY uk_codigo (codigo_comunicacion)
- INDEX idx_denuncia (id_denuncia)
- INDEX idx_fecha (fecha_envio)
- INDEX idx_leido (es_leido)
- FOREIGN KEY (id_denuncia) REFERENCES Denuncia(id_denuncia) ON DELETE CASCADE
- FOREIGN KEY (id_usuario_remitente) REFERENCES Usuario(id_usuario)

---

## 3. Módulo de Notificaciones

### Diccionario de Datos

#### Tabla: Notificacion
- **Descripción:** Mensaje enviado a usuarios sobre eventos del sistema.
- **Propósito:** Mantener informados a los usuarios sobre cambios en sus denuncias.
- **Reglas de Negocio:**
  - Se genera automáticamente según eventos configurados.
  - Puede enviarse por múltiples canales.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_notificacion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 650f8400-e29b-41d4-a716-446655440034 |
| codigo_notificacion | Código de notificación | Identificación | VARCHAR(20) | Sí | Sí | No | NOT-00001 |
| tipo_notificacion | Tipo de notificación | Clasificación | VARCHAR(50) | Sí | No | No | Cambio de estado |
| fecha_creacion | Fecha de creación | Control temporal | DATETIME | Sí | No | No | 2025-01-11 10:05:00 |
| fecha_envio | Fecha de envío | Control temporal | DATETIME | No | No | No | 2025-01-11 10:06:00 |
| canal_envio | Canal utilizado | Medio | VARCHAR(20) | Sí | No | No | Email |
| estado_envio | Estado del envío | Seguimiento | VARCHAR(20) | Sí | No | No | Enviado |
| mensaje_personalizado | Contenido del mensaje | Comunicación | TEXT | Sí | No | No | Su denuncia ha sido... |
| intento_envio | Número de intentos | Control | INT | Sí | No | No | 1 |
| id_denuncia | Denuncia asociada | Relación | CHAR(36) | Sí | No | Sí | a50e8400-e29b-41d4-a716-446655440022 |
| id_usuario | Usuario destinatario | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |
| id_plantilla | Plantilla utilizada | Relación | CHAR(36) | Sí | No | Sí | 750f8400-e29b-41d4-a716-446655440035 |

**Índices:**
- PRIMARY KEY (id_notificacion)
- UNIQUE KEY uk_codigo (codigo_notificacion)
- INDEX idx_usuario (id_usuario)
- INDEX idx_denuncia (id_denuncia)
- INDEX idx_estado (estado_envio)
- INDEX idx_canal (canal_envio)
- FOREIGN KEY (id_denuncia) REFERENCES Denuncia(id_denuncia) ON DELETE CASCADE
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario)
- FOREIGN KEY (id_plantilla) REFERENCES PlantillaNotificacion(id_plantilla)

---

#### Tabla: PlantillaNotificacion
- **Descripción:** Plantilla predefinida para generar notificaciones.
- **Propósito:** Estandarizar el contenido de las notificaciones según el evento.
- **Reglas de Negocio:**
  - Debe contener variables dinámicas.
  - Debe estar activa para ser utilizada.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_plantilla | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 750f8400-e29b-41d4-a716-446655440035 |
| codigo_plantilla | Código de plantilla | Identificación | VARCHAR(20) | Sí | Sí | No | PLT-001 |
| nombre | Nombre de la plantilla | Identificación | VARCHAR(100) | Sí | Sí | No | Registro exitoso |
| tipo_evento | Evento que dispara | Clasificación | VARCHAR(50) | Sí | No | No | Registro |
| asunto | Asunto del mensaje | Email | VARCHAR(200) | Sí | No | No | Denuncia registrada |
| cuerpo_mensaje | Contenido de la plantilla | Comunicación | TEXT | Sí | No | No | Estimado {nombre}... |
| variables | Variables disponibles (JSON) | Configuración | TEXT | No | No | No | ["nombre", "codigo"] |
| esta_activa | Estado de la plantilla | Control | BOOLEAN | Sí | No | No | true |

**Índices:**
- PRIMARY KEY (id_plantilla)
- UNIQUE KEY uk_codigo (codigo_plantilla)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_tipo_evento (tipo_evento)
- INDEX idx_activa (esta_activa)

---

#### Tabla: ConfiguracionNotificacion
- **Descripción:** Preferencias de notificación por usuario.
- **Propósito:** Permitir a los usuarios configurar cómo recibir notificaciones.
- **Reglas de Negocio:**
  - Cada usuario puede tener una configuración personalizada.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_configuracion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 850f8400-e29b-41d4-a716-446655440036 |
| codigo_configuracion | Código de configuración | Identificación | VARCHAR(20) | Sí | Sí | No | CFG-00001 |
| recibir_email | Habilitar email | Configuración | BOOLEAN | Sí | No | No | true |
| recibir_sms | Habilitar SMS | Configuración | BOOLEAN | Sí | No | No | false |
| recibir_push | Habilitar notificaciones push | Configuración | BOOLEAN | Sí | No | No | true |
| frecuencia_resumen | Frecuencia de resúmenes | Configuración | VARCHAR(20) | Sí | No | No | Diario |
| horario_preferido | Horario para recibir | Configuración | VARCHAR(50) | No | No | No | 09:00-18:00 |
| id_usuario | Usuario asociado | Relación | CHAR(36) | Sí | Sí | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_configuracion)
- UNIQUE KEY uk_codigo (codigo_configuracion)
- UNIQUE KEY uk_usuario (id_usuario)
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario) ON DELETE CASCADE

---

## 4. Módulo Administrativo

### Diccionario de Datos

#### Tabla: Usuario
- **Descripción:** Entidad general que representa cualquier usuario del sistema.
- **Propósito:** Gestionar el acceso y autenticación de todos los usuarios.
- **Reglas de Negocio:**
  - Cada usuario debe tener credenciales únicas.
  - Debe tener al menos un rol asignado.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_usuario | Identificador único del usuario | PK UUID | CHAR(36) | Sí | Sí | No | e50e8400-e29b-41d4-a716-446655440026 |
| codigo_usuario | Código del usuario | Identificación | VARCHAR(20) | Sí | Sí | No | USR-00001 |
| nombre_usuario | Nombre de usuario | Autenticación | VARCHAR(50) | Sí | Sí | No | jperez |
| password_hash | Contraseña hasheada | Seguridad | VARCHAR(255) | Sí | No | No | $2b$12$... |
| email | Correo electrónico | Comunicación | VARCHAR(100) | Sí | Sí | No | jperez@email.com |
| fecha_creacion | Fecha de creación | Control temporal | DATETIME | Sí | No | No | 2025-01-01 08:00:00 |
| ultimo_acceso | Último inicio de sesión | Auditoría | DATETIME | No | No | No | 2025-01-10 14:25:00 |
| estado_cuenta | Estado de la cuenta | Control | VARCHAR(20) | Sí | No | No | Activo |
| intentos_login | Intentos fallidos de login | Seguridad | INT | Sí | No | No | 0 |
| fecha_bloqueo | Fecha de bloqueo | Seguridad | DATETIME | No | No | No | NULL |
| requiere_mfa | Requiere autenticación 2FA | Seguridad | BOOLEAN | Sí | No | No | false |
| token_mfa | Token para 2FA | Seguridad | VARCHAR(255) | No | No | No | NULL |

**Índices:**
- PRIMARY KEY (id_usuario)
- UNIQUE KEY uk_codigo (codigo_usuario)
- UNIQUE KEY uk_nombre_usuario (nombre_usuario)
- UNIQUE KEY uk_email (email)
- INDEX idx_estado (estado_cuenta)
- INDEX idx_ultimo_acceso (ultimo_acceso)

---

#### Tabla: Rol
- **Descripción:** Rol de usuario en el sistema con permisos específicos.
- **Propósito:** Implementar control de acceso basado en roles (RBAC).
- **Reglas de Negocio:**
  - Cada rol tiene un conjunto único de permisos.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_rol | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 950f8400-e29b-41d4-a716-446655440037 |
| codigo_rol | Código del rol | Identificación | VARCHAR(20) | Sí | Sí | No | ROL-001 |
| nombre | Nombre del rol | Identificación | VARCHAR(50) | Sí | Sí | No | Operador |
| descripcion | Descripción del rol | Información | VARCHAR(500) | No | No | No | Personal que gestiona... |
| nivel | Nivel jerárquico | Jerarquía | INT | Sí | No | No | 2 |
| es_sistema | Rol del sistema (no editable) | Control | BOOLEAN | Sí | No | No | true |
| esta_activo | Estado del rol | Control | BOOLEAN | Sí | No | No | true |

**Índices:**
- PRIMARY KEY (id_rol)
- UNIQUE KEY uk_codigo (codigo_rol)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_activo (esta_activo)
- INDEX idx_nivel (nivel)

---

#### Tabla: Permiso
- **Descripción:** Permiso específico para realizar acciones en el sistema.
- **Propósito:** Definir granularmente qué acciones puede realizar cada rol.
- **Reglas de Negocio:**
  - Los permisos son atómicos y específicos.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_permiso | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | a50f8400-e29b-41d4-a716-446655440038 |
| codigo_permiso | Código del permiso | Identificación | VARCHAR(20) | Sí | Sí | No | PER-001 |
| nombre | Nombre del permiso | Identificación | VARCHAR(100) | Sí | Sí | No | CREAR_DENUNCIA |
| descripcion | Descripción del permiso | Información | VARCHAR(500) | No | No | No | Permite crear denuncias |
| modulo | Módulo del sistema | Clasificación | VARCHAR(50) | Sí | No | No | Denuncias |
| accion | Acción permitida | Operación | VARCHAR(50) | Sí | No | No | Crear |
| recurso | Recurso sobre el que actúa | Entidad | VARCHAR(50) | Sí | No | No | Denuncia |

**Índices:**
- PRIMARY KEY (id_permiso)
- UNIQUE KEY uk_codigo (codigo_permiso)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_modulo (modulo)
- INDEX idx_accion (accion)

---

#### Tabla: UsuarioRol
- **Descripción:** Relación entre usuarios y roles (N:M).
- **Propósito:** Permitir que un usuario tenga múltiples roles.
- **Reglas de Negocio:**
  - Un usuario puede tener múltiples roles.
  - Un rol puede ser asignado a múltiples usuarios.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_usuario | Referencia al usuario | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |
| id_rol | Referencia al rol | Relación | CHAR(36) | Sí | No | Sí | 950f8400-e29b-41d4-a716-446655440037 |
| fecha_asignacion | Fecha de asignación | Control temporal | DATETIME | Sí | No | No | 2025-01-01 08:30:00 |
| es_activo | Estado de la asignación | Control | BOOLEAN | Sí | No | No | true |

**Índices:**
- PRIMARY KEY (id_usuario, id_rol)
- INDEX idx_usuario (id_usuario)
- INDEX idx_rol (id_rol)
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario) ON DELETE CASCADE
- FOREIGN KEY (id_rol) REFERENCES Rol(id_rol) ON DELETE CASCADE

---

#### Tabla: RolPermiso
- **Descripción:** Relación entre roles y permisos (N:M).
- **Propósito:** Asignar permisos específicos a cada rol.
- **Reglas de Negocio:**
  - Un rol puede tener múltiples permisos.
  - Un permiso puede pertenecer a múltiples roles.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_rol | Referencia al rol | Relación | CHAR(36) | Sí | No | Sí | 950f8400-e29b-41d4-a716-446655440037 |
| id_permiso | Referencia al permiso | Relación | CHAR(36) | Sí | No | Sí | a50f8400-e29b-41d4-a716-446655440038 |
| fecha_asignacion | Fecha de asignación | Control | DATETIME | Sí | No | No | 2025-01-01 08:00:00 |

**Índices:**
- PRIMARY KEY (id_rol, id_permiso)
- INDEX idx_rol (id_rol)
- INDEX idx_permiso (id_permiso)
- FOREIGN KEY (id_rol) REFERENCES Rol(id_rol) ON DELETE CASCADE
- FOREIGN KEY (id_permiso) REFERENCES Permiso(id_permiso) ON DELETE CASCADE

---

#### Tabla: Sesion
- **Descripción:** Sesión activa de un usuario en el sistema.
- **Propósito:** Gestionar las sesiones de usuario y tokens de autenticación.
- **Reglas de Negocio:**
  - Cada sesión tiene un token único.
  - Las sesiones expiran después de un tiempo de inactividad.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_sesion | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | b50f8400-e29b-41d4-a716-446655440039 |
| codigo_sesion | Código de sesión | Identificación | VARCHAR(20) | Sí | Sí | No | SES-00001 |
| token | Token de sesión | Autenticación | VARCHAR(500) | Sí | Sí | No | eyJhbGciOiJIUzI1... |
| fecha_inicio | Fecha de inicio | Control temporal | DATETIME | Sí | No | No | 2025-01-10 14:25:00 |
| fecha_expiracion | Fecha de expiración | Control temporal | DATETIME | Sí | No | No | 2025-01-10 22:25:00 |
| direccion_ip | IP del usuario | Seguridad | VARCHAR(45) | Sí | No | No | 192.168.1.100 |
| user_agent | Información del navegador | Auditoría | VARCHAR(500) | Sí | No | No | Mozilla/5.0... |
| esta_activa | Estado de la sesión | Control | BOOLEAN | Sí | No | No | true |
| ultima_actividad | Última actividad registrada | Monitoreo | DATETIME | Sí | No | No | 2025-01-10 18:15:00 |
| id_usuario | Usuario de la sesión | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_sesion)
- UNIQUE KEY uk_codigo (codigo_sesion)
- UNIQUE KEY uk_token (token)
- INDEX idx_usuario (id_usuario)
- INDEX idx_activa (esta_activa)
- INDEX idx_expiracion (fecha_expiracion)
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario) ON DELETE CASCADE

---

#### Tabla: LogAuditoria
- **Descripción:** Registro inmutable de todas las acciones críticas del sistema.
- **Propósito:** Mantener trazabilidad completa para auditoría y cumplimiento legal.
- **Reglas de Negocio:**
  - Todos los registros son inmutables.
  - Se deben conservar por al menos 5 años.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_log | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | c50f8400-e29b-41d4-a716-446655440040 |
| codigo_log | Código del log | Identificación | VARCHAR(20) | Sí | Sí | No | LOG-00001 |
| tipo_accion | Tipo de acción realizada | Clasificación | VARCHAR(50) | Sí | No | No | CREAR |
| modulo | Módulo del sistema | Clasificación | VARCHAR(50) | Sí | No | No | Denuncias |
| entidad | Entidad afectada | Recurso | VARCHAR(50) | Sí | No | No | Denuncia |
| entidad_id | ID de la entidad | Referencia | VARCHAR(36) | Sí | No | No | DEN-2025-00001 |
| fecha_hora | Fecha y hora de la acción | Temporal | DATETIME | Sí | No | No | 2025-01-10 14:30:00 |
| direccion_ip | IP del usuario | Seguridad | VARCHAR(45) | Sí | No | No | 192.168.1.100 |
| datos_antes | Estado anterior (JSON) | Auditoría | TEXT | No | No | No | {"estado":"Nuevo"} |
| datos_despues | Estado posterior (JSON) | Auditoría | TEXT | No | No | No | {"estado":"Revisión"} |
| resultado | Resultado de la acción | Estado | VARCHAR(20) | Sí | No | No | Exitoso |
| mensaje_error | Mensaje de error si aplica | Diagnóstico | TEXT | No | No | No | NULL |
| id_usuario | Usuario que realiza la acción | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_log)
- UNIQUE KEY uk_codigo (codigo_log)
- INDEX idx_usuario (id_usuario)
- INDEX idx_fecha (fecha_hora)
- INDEX idx_tipo_accion (tipo_accion)
- INDEX idx_modulo (modulo)
- INDEX idx_entidad (entidad, entidad_id)
- FOREIGN KEY (id_usuario) REFERENCES Usuario(id_usuario)

---

## 5. Módulo de Reportes y Estadísticas

### Diccionario de Datos

#### Tabla: Reporte
- **Descripción:** Documento que consolida información analítica del sistema.
- **Propósito:** Generar informes ejecutivos y operativos para toma de decisiones.
- **Reglas de Negocio:**
  - Puede ser generado manual o automáticamente.
  - Debe indicar el período de análisis.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_reporte | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | d50f8400-e29b-41d4-a716-446655440041 |
| codigo_reporte | Código del reporte | Identificación | VARCHAR(20) | Sí | Sí | No | REP-00001 |
| tipo_reporte | Tipo de reporte | Clasificación | VARCHAR(50) | Sí | No | No | Ejecutivo |
| nombre | Nombre del reporte | Identificación | VARCHAR(200) | Sí | No | No | Reporte mensual enero |
| descripcion | Descripción del contenido | Información | TEXT | No | No | No | Consolidado de... |
| fecha_generacion | Fecha de generación | Control temporal | DATETIME | Sí | No | No | 2025-02-01 08:00:00 |
| fecha_inicio | Inicio del período | Rango temporal | DATE | Sí | No | No | 2025-01-01 |
| fecha_fin | Fin del período | Rango temporal | DATE | Sí | No | No | 2025-01-31 |
| formato_exportacion | Formato de exportación | Configuración | VARCHAR(10) | Sí | No | No | PDF |
| ruta_archivo | Ruta del archivo generado | Almacenamiento | VARCHAR(500) | No | Sí | No | /reports/2025/01/... |
| es_publico | Visible públicamente | Privacidad | BOOLEAN | Sí | No | No | false |
| id_usuario_generador | Usuario que genera | Relación | CHAR(36) | Sí | No | Sí | e50e8400-e29b-41d4-a716-446655440026 |

**Índices:**
- PRIMARY KEY (id_reporte)
- UNIQUE KEY uk_codigo (codigo_reporte)
- INDEX idx_tipo (tipo_reporte)
- INDEX idx_fecha_generacion (fecha_generacion)
- INDEX idx_periodo (fecha_inicio, fecha_fin)
- FOREIGN KEY (id_usuario_generador) REFERENCES Usuario(id_usuario)

---

#### Tabla: Estadistica
- **Descripción:** Métricas y datos estadísticos del sistema.
- **Propósito:** Almacenar indicadores clave de desempeño (KPIs).
- **Reglas de Negocio:**
  - Se calcula periódicamente (diario, semanal, mensual).

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_estadistica | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | e50f8400-e29b-41d4-a716-446655440042 |
| codigo_estadistica | Código de estadística | Identificación | VARCHAR(20) | Sí | Sí | No | EST-00001 |
| tipo_metrica | Tipo de métrica | Clasificación | VARCHAR(50) | Sí | No | No | Tiempo respuesta |
| valor | Valor calculado | Dato | DECIMAL(10,2) | Sí | No | No | 48.50 |
| unidad_medida | Unidad de la métrica | Referencia | VARCHAR(20) | Sí | No | No | horas |
| periodo | Período de cálculo | Temporal | VARCHAR(20) | Sí | No | No | Mensual |
| fecha_calculo | Fecha de cálculo | Control temporal | DATETIME | Sí | No | No | 2025-02-01 00:00:00 |
| categoria | Categoría analizada | Dimensión | VARCHAR(100) | No | No | No | Alumbrado |
| area | Área analizada | Dimensión | VARCHAR(100) | No | No | No | Obras Públicas |
| zona | Zona geográfica | Dimensión | VARCHAR(100) | No | No | No | Distrito Norte |

**Índices:**
- PRIMARY KEY (id_estadistica)
- UNIQUE KEY uk_codigo (codigo_estadistica)
- INDEX idx_tipo_metrica (tipo_metrica)
- INDEX idx_periodo (periodo)
- INDEX idx_fecha (fecha_calculo)
- INDEX idx_categoria (categoria)
- INDEX idx_area (area)

---

#### Tabla: Indicador
- **Descripción:** Indicador de desempeño o KPI del sistema.
- **Propósito:** Medir el rendimiento del sistema y áreas responsables.
- **Reglas de Negocio:**
  - Debe tener valores mínimos y máximos aceptables.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_indicador | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | f50f8400-e29b-41d4-a716-446655440043 |
| codigo_indicador | Código del indicador | Identificación | VARCHAR(20) | Sí | Sí | No | IND-001 |
| nombre | Nombre del indicador | Identificación | VARCHAR(100) | Sí | Sí | No | Tasa de resolución |
| descripcion | Descripción del indicador | Información | TEXT | Sí | No | No | Porcentaje de denuncias... |
| formula | Fórmula de cálculo | Configuración | VARCHAR(500) | Sí | No | No | (resueltas/total)*100 |
| valor_minimo | Valor mínimo aceptable | Umbral | DECIMAL(10,2) | No | No | No | 70.00 |
| valor_maximo | Valor máximo esperado | Umbral | DECIMAL(10,2) | No | No | No | 100.00 |
| valor_actual | Valor actual calculado | Métrica | DECIMAL(10,2) | No | No | No | 85.50 |
| frecuencia_actualizacion | Frecuencia de cálculo | Configuración | VARCHAR(20) | Sí | No | No | Diario |
| tipo_visualizacion | Tipo de gráfico | UI | VARCHAR(20) | Sí | No | No | Gauge |

**Índices:**
- PRIMARY KEY (id_indicador)
- UNIQUE KEY uk_codigo (codigo_indicador)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_frecuencia (frecuencia_actualizacion)

---

#### Tabla: Dashboard
- **Descripción:** Panel de control con visualización de indicadores.
- **Propósito:** Presentar información consolidada de forma visual.
- **Reglas de Negocio:**
  - Puede ser personalizado por rol.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_dashboard | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 050g8400-e29b-41d4-a716-446655440044 |
| codigo_dashboard | Código del dashboard | Identificación | VARCHAR(20) | Sí | Sí | No | DSH-001 |
| nombre | Nombre del dashboard | Identificación | VARCHAR(100) | Sí | Sí | No | Dashboard Ejecutivo |
| descripcion | Descripción del contenido | Información | TEXT | No | No | No | Vista general... |
| tipo_dashboard | Tipo de dashboard | Clasificación | VARCHAR(50) | Sí | No | No | Ejecutivo |
| frecuencia_actualizacion | Frecuencia de actualización | Configuración | VARCHAR(20) | Sí | No | No | Tiempo real |
| es_publico | Visible públicamente | Privacidad | BOOLEAN | Sí | No | No | true |
| orden_visualizacion | Orden de widgets | UI | INT | No | No | No | 1 |

**Índices:**
- PRIMARY KEY (id_dashboard)
- UNIQUE KEY uk_codigo (codigo_dashboard)
- UNIQUE KEY uk_nombre (nombre)
- INDEX idx_tipo (tipo_dashboard)
- INDEX idx_publico (es_publico)

---

#### Tabla: DashboardIndicador
- **Descripción:** Relación entre dashboards e indicadores (N:M).
- **Propósito:** Asignar indicadores a dashboards con configuración específica.
- **Reglas de Negocio:**
  - Un dashboard puede contener múltiples indicadores.
  - Un indicador puede aparecer en múltiples dashboards.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_dashboard | Referencia al dashboard | Relación | CHAR(36) | Sí | No | Sí | 050g8400-e29b-41d4-a716-446655440044 |
| id_indicador | Referencia al indicador | Relación | CHAR(36) | Sí | No | Sí | f50f8400-e29b-41d4-a716-446655440043 |
| orden | Orden de presentación | UI | INT | Sí | No | No | 1 |
| tipo_visualizacion | Tipo de gráfico específico | UI | VARCHAR(20) | Sí | No | No | BarChart |
| fecha_asignacion | Fecha de asignación | Control | DATETIME | Sí | No | No | 2025-01-01 08:00:00 |

**Índices:**
- PRIMARY KEY (id_dashboard, id_indicador)
- INDEX idx_dashboard (id_dashboard)
- INDEX idx_indicador (id_indicador)
- FOREIGN KEY (id_dashboard) REFERENCES Dashboard(id_dashboard) ON DELETE CASCADE
- FOREIGN KEY (id_indicador) REFERENCES Indicador(id_indicador) ON DELETE CASCADE

---

#### Tabla: TendenciaGeografica
- **Descripción:** Análisis de tendencias por zona geográfica.
- **Propósito:** Identificar patrones espaciales de las denuncias.
- **Reglas de Negocio:**
  - Se calcula por períodos definidos.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_tendencia | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 150g8400-e29b-41d4-a716-446655440045 |
| codigo_tendencia | Código de tendencia | Identificación | VARCHAR(20) | Sí | Sí | No | TEN-00001 |
| zona | Zona geográfica | Ubicación | VARCHAR(100) | Sí | No | No | Distrito Centro |
| distrito | Distrito municipal | Ubicación | VARCHAR(100) | Sí | No | No | Lima |
| cantidad_denuncias | Total de denuncias | Métrica | INT | Sí | No | No | 150 |
| categoria_mas_frecuente | Categoría predominante | Análisis | VARCHAR(100) | Sí | No | No | Baches |
| tasa_resolucion | Porcentaje de resolución | Métrica | DECIMAL(5,2) | Sí | No | No | 82.50 |
| tiempo_promedio_atencion | Tiempo promedio en horas | Métrica | DECIMAL(10,2) | Sí | No | No | 45.20 |
| periodo_analisis | Período del análisis | Temporal | VARCHAR(20) | Sí | No | No | 2025-01 |
| nivel_criticidad | Nivel de criticidad de la zona | Clasificación | VARCHAR(20) | Sí | No | No | Media |

**Índices:**
- PRIMARY KEY (id_tendencia)
- UNIQUE KEY uk_codigo (codigo_tendencia)
- INDEX idx_zona (zona)
- INDEX idx_distrito (distrito)
- INDEX idx_periodo (periodo_analisis)
- INDEX idx_criticidad (nivel_criticidad)

---

#### Tabla: RankingDesempeno
- **Descripción:** Ranking de desempeño de áreas responsables.
- **Propósito:** Comparar el rendimiento entre diferentes áreas.
- **Reglas de Negocio:**
  - Se actualiza periódicamente.

| **Columna** | **Descripción** | **Propósito** | **Tipo** | **NN** | **UK** | **FK** | **Ejemplo** |
|-------------|-----------------|---------------|----------|--------|--------|--------|-------------|
| id_ranking | Identificador único | PK UUID | CHAR(36) | Sí | Sí | No | 250g8400-e29b-41d4-a716-446655440046 |
| codigo_ranking | Código del ranking | Identificación | VARCHAR(20) | Sí | Sí | No | RNK-00001 |
| periodo_evaluacion | Período evaluado | Temporal | VARCHAR(20) | Sí | No | No | 2025-01 |
| posicion | Posición en el ranking | Clasificación | INT | Sí | No | No | 1 |
| puntaje_total | Puntaje total obtenido | Métrica | DECIMAL(5,2) | Sí | No | No | 95.50 |
| denuncias_atendidas | Total de denuncias atendidas | Métrica | INT | Sí | No | No | 120 |
| tasa_resolucion_area | Tasa de resolución del área | Métrica | DECIMAL(5,2) | Sí | No | No | 88.30 |
| tiempo_promedio_area | Tiempo promedio del área | Métrica | DECIMAL(10,2) | Sí | No | No | 38.50 |
| calificacion_promedio | Calificación promedio ciudadana | Satisfacción | DECIMAL(3,2) | No | No | No | 4.50 |
| id_area_responsable | Área evaluada | Relación | CHAR(36) | Sí | No | Sí | 950e8400-e29b-41d4-a716-446655440021 |

**Índices:**
- PRIMARY KEY (id_ranking)
- UNIQUE KEY uk_codigo (codigo_ranking)
- UNIQUE KEY uk_area_periodo (id_area_responsable, periodo_evaluacion)
- INDEX idx_periodo (periodo_evaluacion)
- INDEX idx_posicion (posicion)
- FOREIGN KEY (id_area_responsable) REFERENCES AreaResponsable(id_area_responsable)

---

## Convenciones y Estándares

### Nomenclatura
- **Tablas:** PascalCase (ej: PersonalMunicipal)
- **Columnas:** snake_case (ej: fecha_registro)
- **Índices:** 
  - PK: `PRIMARY KEY (id_tabla)`
  - UK: `uk_nombre_campo`
  - FK: `FOREIGN KEY (id_referencia)`
  - INDEX: `idx_nombre_campo`

### Tipos de Datos
- **UUID:** CHAR(36) para identificadores únicos
- **Códigos:** VARCHAR(20) para códigos de negocio
- **Fechas:** DATE para fechas, DATETIME para fecha y hora
- **Booleanos:** BOOLEAN
- **Decimales:** DECIMAL(10,2) para montos
- **Textos:** VARCHAR para textos cortos, TEXT para textos largos

### Reglas de Integridad
- **ON DELETE CASCADE:** Para eliminación en cascada de registros dependientes
- **ON DELETE SET NULL:** Para referencias opcionales que deben preservarse
- **NOT NULL (NN):** Columnas obligatorias
- **UNIQUE (UK):** Columnas con valores únicos
- **FOREIGN KEY (FK):** Relaciones entre tablas

---